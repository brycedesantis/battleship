(()=>{"use strict";const t=function(t,e){const n={id:t,length:e,hits:[],sunk:!1,direction:"horizontal"};function r(){if(n.hits.length===n.length)return n.sunk=!0,n.sunk}return{stats:n,hit:function(t){n.hits.push(t),r()},getHits:function(){return n.hits},isSunk:r,getDirection:function(){return n.direction},changeDirection:function(){"horizontal"===n.direction?n.direction="vertical":n.direction="horizontal"}}},e=function(e="computer"){return{name:e,fleet:{Carrier:t("carrier",5),Battleship:t("battleship",4),Destroyer:t("destroyer",3),Submarine:t("submarine",3),Patrol:t("patrol",2)},attack:function(t,e,n){n.receiveAttack(t,e)},randomAttack:function t(e){let n=Math.floor(10*Math.random()),r=Math.floor(10*Math.random());const o=e.getOcean()[n][r];"miss"===o||"hit"===o?t(e):e.receiveAttack(n,r)}}},n=()=>{let t=Array(10).fill("ocean").map((()=>Array(10).fill("ocean"))),n=[];function r(t,e,n,r){let o=t,a=e+n;return"vertical"===r&&(o=t+n,a=e),[o,a]}function o(e,o,a){const i=t,c=e.getDirection(),l=function(e,n,o,a){const i=[];for(let c=0;c<o;c++){const[o,l]=r(e,n,c,a);if(!(o<10&&l<10))return!1;i.push(t[o][l])}return i.every((t=>"ocean"===t))}(o,a,e.stats.length,c);if(l){for(let t=0;t<e.stats.length;t++){const[n,l]=r(o,a,t,c);i[n][l]={ship:e,index:t}}return n.push(e),l}return l}function a(t){let e=Math.floor(10*Math.random()),n=Math.floor(10*Math.random());Math.random()>.5&&t.changeDirection(),o(t,e,n)||a(t)}return{getOcean:function(){return t},atPosition:function(e,n){return t[e][n]},placeShip:o,receiveAttack:function(e,n){return"ocean"===t[e][n]?(t[e][n]="miss",n):(t[e][n].ship&&(t[e][n].ship.hit(t[e][n].index),t[e][n]="hit"),t[e][n])},allSunk:function(){return n.every((t=>t.isSunk()))},allPlaced:function(){return n.length===Object.keys(e().fleet).length},autoPlaceFleet:function(t){for(const e in t)a(t[e])},resetOcean:function(){t=Array(10).fill("ocean").map((()=>Array(10).fill("ocean"))),n=[]}}},r=function(){const t=(t,e,n)=>`<div class='gamesquare ${n}' data-y=${t} data-x=${e}></div>`;return{makeBoard:function(e,n,r){e.textContent="";const o=n.getOcean(),a=o.length;let i="";for(let e=0;e<a;e++)for(let n=0;n<a;n++){let a=o[e][n];"ocean"===a?a="ocean":a.ship&&(a="computer"!==r.name?a.ship.stats.id:"ocean"),i+=t(e,n,a)}e.insertAdjacentHTML("afterbegin",i)}}};(function(){const t=e("player 1"),o=e(),a=n(),i=n(),c=document.querySelector(".player-grid"),l=document.querySelector(".computer-grid");function u(){r().makeBoard(c,a,t.fleet),r().makeBoard(l,i,o.fleet)}return{player1:t,player2:o,player1Board:a,player2Board:i,renderBoard:u,autoPlace:function(){a.resetOcean(),i.resetOcean(),a.autoPlaceFleet(t.fleet),i.autoPlaceFleet(o.fleet),u()}}})().autoPlace()})();